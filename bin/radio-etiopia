#!/usr/bin/env bash
set -Eeuo pipefail

# Go to the root directory where the docker-compose.yaml file resides.
cd "$(dirname "$(dirname "${BASH_SOURCE[0]}")")"

# Make sure we have the latest docker-compose version that we installed with
# python3 -m venv venv previously.
source venv/bin/activate

# Get the UID and GID of the local user the files belong and should belong to.
DOCKER_UID=$(id -u Richard)
DOCKER_GID=$(id -g users)
export DOCKER_UID DOCKER_GID

# Execute the actual task…
docker-compose --project-name radio-etiopia run radio-etiopia

# Tell AudioStation that the files have changed…
synoindex -R 'music/R/Rádio Etiópia'
